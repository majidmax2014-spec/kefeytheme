<section
  class="kefey-certs"
  style="
    --kcerts-max: {{ section.settings.container_max_width }}px;
    --kcerts-bg: {{ section.settings.section_bg_color }};
    --kcerts-pt: {{ section.settings.section_padding_top }}px;
    --kcerts-pb: {{ section.settings.section_padding_bottom }}px;
    --kcerts-logo-h-d: {{ section.settings.logo_height_desktop }}px;
    --kcerts-logo-h-m: {{ section.settings.logo_height_mobile }}px;
    --kcerts-gap-d: {{ section.settings.gap_desktop }}px;
    --kcerts-gap-m: {{ section.settings.gap_mobile }}px;
    --kcerts-arrow-size: {{ section.settings.arrows_size }}px;
    --kcerts-arrow-color: {{ section.settings.arrows_color }};
  "
>
  <div class="kefey-certs__inner">
    {%- if section.settings.show_heading -%}
      <h2 class="kefey-certs__heading">{{ section.settings.heading }}</h2>
    {%- endif -%}

    <div class="kefey-certs__carousel" data-kefey-certs>
      {%- if section.settings.arrows_enabled -%}
        <button class="kefey-certs__arrow kefey-certs__arrow--prev" type="button" data-kefey-certs-prev aria-label="Previous certifications">
          &#8249;
        </button>
      {%- endif -%}

      <div class="kefey-certs__track" data-kefey-certs-track role="list" aria-label="Certification logos">
        {%- for block in section.blocks -%}
          <div class="kefey-certs__item" style="--kcerts-item-opacity: {{ block.settings.opacity | divided_by: 100.0 }};" role="listitem" {{ block.shopify_attributes }}>
            {%- if block.settings.link != blank -%}
              <a class="kefey-certs__link" href="{{ block.settings.link }}" aria-label="{{ block.settings.alt }}">
                {%- if block.settings.image != blank -%}
                  {{
                    block.settings.image
                    | image_url: width: 420
                    | image_tag:
                      class: 'kefey-certs__logo',
                      widths: '120, 180, 260, 340, 420',
                      sizes: '(min-width: 990px) 180px, 120px',
                      loading: 'lazy',
                      alt: block.settings.alt
                  }}
                {%- endif -%}
              </a>
            {%- else -%}
              {%- if block.settings.image != blank -%}
                {{
                  block.settings.image
                  | image_url: width: 420
                  | image_tag:
                    class: 'kefey-certs__logo',
                    widths: '120, 180, 260, 340, 420',
                    sizes: '(min-width: 990px) 180px, 120px',
                    loading: 'lazy',
                    alt: block.settings.alt
                }}
              {%- endif -%}
            {%- endif -%}
          </div>
        {%- endfor -%}
      </div>

      {%- if section.settings.arrows_enabled -%}
        <button class="kefey-certs__arrow kefey-certs__arrow--next" type="button" data-kefey-certs-next aria-label="Next certifications">
          &#8250;
        </button>
      {%- endif -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Kefey Certs",
  "settings": [
    { "type": "checkbox", "id": "show_heading", "label": "Show heading", "default": false },
    { "type": "text", "id": "heading", "label": "Heading", "default": "Certifications" },
    { "type": "range", "id": "container_max_width", "label": "Container max width", "min": 900, "max": 1800, "step": 20, "default": 1320, "unit": "px" },
    { "type": "color", "id": "section_bg_color", "label": "Section background", "default": "#ffffff" },
    { "type": "range", "id": "section_padding_top", "label": "Padding top", "min": 0, "max": 160, "step": 4, "default": 24, "unit": "px" },
    { "type": "range", "id": "section_padding_bottom", "label": "Padding bottom", "min": 0, "max": 160, "step": 4, "default": 24, "unit": "px" },
    { "type": "range", "id": "logo_height_desktop", "label": "Logo height desktop", "min": 40, "max": 180, "step": 2, "default": 96, "unit": "px" },
    { "type": "range", "id": "logo_height_mobile", "label": "Logo height mobile", "min": 40, "max": 120, "step": 2, "default": 68, "unit": "px" },
    { "type": "range", "id": "gap_desktop", "label": "Gap desktop", "min": 8, "max": 80, "step": 2, "default": 34, "unit": "px" },
    { "type": "range", "id": "gap_mobile", "label": "Gap mobile", "min": 6, "max": 40, "step": 1, "default": 16, "unit": "px" },
    { "type": "checkbox", "id": "arrows_enabled", "label": "Show arrows", "default": true },
    { "type": "range", "id": "arrows_size", "label": "Arrows size", "min": 24, "max": 80, "step": 2, "default": 48, "unit": "px" },
    { "type": "color", "id": "arrows_color", "label": "Arrows color", "default": "#111111" }
  ],
  "blocks": [
    {
      "type": "logo",
      "name": "Logo",
      "settings": [
        { "type": "image_picker", "id": "image", "label": "Logo image" },
        { "type": "text", "id": "alt", "label": "Alt text", "default": "Certification logo" },
        { "type": "url", "id": "link", "label": "Optional link" },
        { "type": "range", "id": "opacity", "label": "Opacity", "min": 20, "max": 100, "step": 1, "default": 100, "unit": "%" }
      ]
    }
  ],
  "max_blocks": 20,
  "presets": [
    {
      "name": "Kefey Certs",
      "blocks": [
        { "type": "logo", "settings": { "alt": "Gluten Free certification" } },
        { "type": "logo", "settings": { "alt": "Purity Award certification" } },
        { "type": "logo", "settings": { "alt": "Certified Vegan certification" } },
        { "type": "logo", "settings": { "alt": "USDA Organic certification" } },
        { "type": "logo", "settings": { "alt": "NSF certification" } },
        { "type": "logo", "settings": { "alt": "Non GMO Project certification" } }
      ]
    }
  ]
}
{% endschema %}
